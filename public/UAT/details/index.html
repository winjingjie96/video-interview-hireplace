<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Events</title>
    <link rel="stylesheet" href="tailwind.css" />
  </head>
  <body>
    <script
      src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.0.1/dist/alpine.js"
      defer
    ></script>

    <div class="relative bg-gray-100 overflow-hidden" id="detail-event">
      <div v-if="loading" style="position:fixed;top:0;bottom:0;right:0;left:0;background-color:rgba(0,0,0,.4);z-index:99;display:flex;justify-content:center;align-items:center;">
        <img src="/assets/img/loading.gif" width="100px" />
      </div>
      <div
        x-data="{ open: false }"
        class="relative pb-1 md:pb-3 lg:pb-2 xl:pb-4"
        v-else
      >
        <div class="bg-gray-900 pt-6 pb-64">
          <nav
            class="relative max-w-screen-xl mx-auto flex items-center justify-between px-4 sm:px-6"
          >
            <div class="flex items-center flex-1">
              <div class="flex items-center justify-between w-full md:w-auto">
                <a href="#">
                  <img
                    class="h-8 w-auto sm:h-10"
                    src="https://www.hireplace.com/assets/svg/logo-white.svg"
                    alt=""
                  />
                </a>
                <div class="-mr-2 flex items-center md:hidden">
                  <button
                    @click="open = true"
                    type="button"
                    class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 focus:text-gray-500 transition duration-150 ease-in-out"
                  >
                    <svg
                      class="h-6 w-6"
                      stroke="currentColor"
                      fill="none"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M4 6h16M4 12h16M4 18h16"
                      />
                    </svg>
                  </button>
                </div>
              </div>

            </div>
            <div class="hidden md:block text-right">
              <span class="inline-flex rounded-md shadow-md">
                <span class="inline-flex rounded-md shadow-xs">
                  <a
                    href="https://docs.google.com/forms/d/e/1FAIpQLSfH0vW392E9GPj-G0LqR2h1ixViv81aach31e5SiQjJrMsfZA/viewform"
                    class="inline-flex items-center px-4 py-2 border border-transparent text-base leading-6 font-medium rounded-md text-pink-600 bg-white hover:bg-gray-50 focus:outline-none focus:shadow-outline transition duration-150 ease-in-out"
                  >
                    Contact Us
                  </a>
                </span>
              </span>
            </div>
          </nav>
          <header class="py-10"></header>
        </div>

        <main class="-mt-64">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="relative bg-white">
              <div
                class="h-56 bg-white sm:h-72 md:absolute md:left-0 md:h-full md:w-2/3"
              >
                <img
                  class="w-full h-full object-cover"
                  :src="detail.fields['Event Image'][0].thumbnails.large.url"
                  :alt="detail.fields['Name of the Event']"
                />
              </div>
              <div
                class="relative max-w-screen-xl mx-auto px-4 py-12 sm:px-6 lg:px-8 lg:py-16"
              >
                <div class="md:ml-auto md:w-1/3 md:pl-10">
                  <!-- <div class="text-base leading-6 font-semibold uppercase tracking-wider text-gray-300">
                  Award winning support
                </div> -->
                  <h2
                    class="mt-2 text-black text-3xl leading-9 font-extrabold tracking-tight sm:text-4xl sm:leading-10"
                  >
                    {{ convertEventName(detail.fields["Name of the Event"]) }}<br /><br />
                    <span class="text-2xl font-bold"
                      >{{ getDateEvent(detail.fields["Date and time of your event"]) }} <br />{{ getTimeEvent(detail.fields["Date and time of your event"]) }} </span
                    ><br />
                  </h2>

                  <p class="mt-6 text-sm leading-5 text-gray-800">
                    By {{ detail.fields["Company Name"] }}
                    <br />
                    <div v-html="detail.fields['Event Description']"></div>
                  </p>
                  <div class="mt-8">
                    <label
                      for="email"
                      class="block text-sm font-medium sm:text-lg leading-5 text-gray-700"
                      >Email</label
                    >
                  </div>


                  <form
                  form action="https://airtable.com/shrucCGtWJwHjKaQe" method="GET"
                    class="mt-2 max-w-md mx-auto  sm:justify-center md:mt-4"
                  >


                    <div class="rounded-md shadow">
                      <input type= "email" required aria-label="Email"  name="prefill_Email" class="form-input block w-full sm:text-md sm:leading-5" placeholder="you@example.com" />

                    </div>               
                    <div class="mt-3 rounded-md shadow sm:mt-2 ">
                      <button type="submit" class="w-full flex items-center justify-center px-8 py-3 border border-transparent text-base leading-6 font-medium rounded-md text-white bg-pink-600 hover:bg-pink-500 focus:outline-none focus:shadow-outline-pink transition duration-150 ease-in-out md:py-4 md:px-4">
                        Register as Candidate
                      </button>
                    </div>
                  </form>
                  
                  <form
                  form action="https://airtable.com/shrfzMpSnAXkrkUo5" method="GET"
                    class="mt-2 max-w-md mx-auto  sm:justify-center md:mt-4"
                  >


                    <div class="rounded-md shadow">
                      <input type= "email" required aria-label="Email"  name="prefill_Email" class="form-input block w-full sm:text-md sm:leading-5" placeholder="you@example.com" />

                    </div>               
                    <div class="mt-3 rounded-md shadow sm:mt-2 ">
                      <button type="submit"class="w-full flex items-center justify-center px-8 py-3 border border-transparent text-base leading-6 font-medium rounded-md text-pink-600 bg-white hover:text-pink-500 focus:outline-none focus:shadow-outline-blue transition duration-150 ease-in-out md:py-4 md:px-4">
                        Register as Employer
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
            <!-- Company and Job Description -->
            <div class="relative bg-white" style="overflow:hidden">
              <div
                class="px-6 sm:block lg:overflow-auto border-b border-gray-200"
              >
                <!-- NavBar for comapnies -->
                <nav class="-mb-px flex">
                  <button
                    v-for="(company, j) in list_companies" :key="j"
                    class="whitespace-no-wrap py-4 px-1 border-b-2 border-transparent font-medium text-sm leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300"
                    :class="{'active': company.fields['Your Company Name'] == company_opened}"
                    @click="openCompany(company.fields['Your Company Name'])"
                  >
                    {{ company.fields['Your Company Name'] }}
                  </button>
                </nav>
              </div>
              <!-- one third of screen -->
              <div
                class="mx-auto px-4 sm:px-6 lg:px-8 md:absolute md:left-0 md:h-full md:w-1/3" style="position:relative;float:left;height:auto"
                v-for="(company_name, k) in list_companies" :key="k"
                v-if="company_name.fields['Your Company Name'] == company_opened"
              >
                <h2
                  class="mt-2 text-gray-900 text-3xl leading-9 font-extrabold tracking-tight sm:text-4xl sm:leading-10"
                >
                  {{ company_name.fields['Your Company Name'] }}
                </h2>
                <h5
                  class="mt-2 text-gray-900 tracking-tight"
                  style="line-height:22px;padding:5px 0 15px"
                >
                  {{ company_name.fields['Company Description'] }}
                </h5>
              </div>
              <div
                class="relative h-auto max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8"
              >
                <div class="md:ml-auto md:w-2/3 md:pl-10">
                  <!-- Tab content -->
                  <div 
                    class="tabcontent"
                    v-for="(company_list, l) in list_companies" :key="l"
                    v-if="company_list.fields['Your Company Name'] == company_opened"
                  >
                    <button class="accordion w-full" @click="openJob(company_list.fields['Job Title'])">
                      <div
                        class="max-w-7xl block hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition duration-150 ease-in-out"
                      >
                        <div class="flex items-center px-4 py-4 sm:px-6">
                          <div class="min-w-0 flex-1 flex items-center">
                            <div class="flex-shrink-0">
                              <img
                                class="h-12 w-12 rounded-full"
                                :src="company_list.fields['Company Logo'][0].thumbnails.small.url"
                                :alt="company_list.fields['Your Company Name']"
                              />
                            </div>
                            <div
                              class="min-w-0 flex-1 px-4 md:grid md:grid-cols-2 md:gap-4"
                            >
                              <div>
                                <div
                                  class="mt-2 flex items-center text-sm font-medium text-pink-600"
                                >
                                  {{ company_list.fields['Job Title'] }}
                                </div>
                              </div>
                              <div class="hidden md:block">
                                <div>
                                  <!-- <div class="text-sm leading-5 text-gray-900">
                                        Applied on
                                        <time datetime="2020-01-07">January 7, 2020</time>
                                      </div> -->
                                  <div
                                    class="text-sm leading-5 flex items-center text-gray-900"
                                  >
                                    <svg
                                      class="flex-shrink-0 mr-1.5 h-5 w-5 text-green-400"
                                      fill="currentColor"
                                      viewBox="0 0 20 20"
                                    >
                                      <path
                                        fill-rule="evenodd"
                                        d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                        clip-rule="evenodd"
                                      />
                                    </svg>
                                    Competitive Rates
                                  </div>
                                  <div
                                    class="mt-2 flex items-center text-sm leading-5 text-gray-900"
                                  >
                                    <svg
                                      class="flex-shrink-0 mr-1.5 h-5 w-5 text-green-400"
                                      fill="currentColor"
                                      viewBox="0 0 20 20"
                                    >
                                      <path
                                        fill-rule="evenodd"
                                        d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                        clip-rule="evenodd"
                                      />
                                    </svg>
                                    Staff Welfare
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div>
                            <svg
                              class="h-5 w-5 text-gray-400"
                              fill="currentColor"
                              viewBox="0 0 20 20"
                            >
                              <path
                                fill-rule="evenodd"
                                d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                                clip-rule="evenodd"
                              />
                            </svg>
                          </div>
                        </div>
                      </div>
                    </button>
                    <div class="panel" :class="{'hidden': company_list.fields['Job Title'] != company_job}">
                      <p
                        class="mt-3 px-6 text-base text-gray-800 sm:mt-5 sm:px-16 sm:text-xl md:px-16 lg:text-lg xl:text-xl"
                      >
                        <span class="text-pink-600 text-lg">
                          Job Description: </span
                        ><br /><br />
                        <p class="px-6 md:px-16" v-html="company_list.fields['Job Description']"></p>
                      </p>
                      <br />
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Previous Section -->
            <div class="bg-white shadow">
              <!-- /End replace -->
            </div>
            <!-- 
CTA -->
            <div
              class="max-w-screen-xl mx-auto text-center py-12 px-4 sm:px-6 lg:py-16 lg:px-8"
            >
              <h2
                class="text-3xl leading-9 font-extrabold tracking-tight text-gray-900 sm:text-4xl sm:leading-10"
              >
                Ready for
                <span class="text-pink-600">speed interviews?</span>
                <br />
                Download the app now.
              </h2>
              <div class="mt-8 flex justify-center">
                <div class="inline-flex rounded-md shadow">
                  <a href="#"
                    ><img
                      class="h-12"
                      src="https://www.seekpng.com/png/full/223-2231228_google-play-store-logo-png.png"
                  /></a>
                </div>
                <div class="ml-3 inline-flex rounded-md shadow">
                  <a href="#"
                    ><img
                      class="h-12"
                      src="https://www.seekpng.com/png/full/7-77874_google-play-png.png"
                  /></a>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"></script>
    <script>
      var api_key = `keyNRXEcdgCPmt6P3`
      var url_airtable = `https://api.airtable.com/v0/app5rN7ZHPPukTR9E`
      
      var queryString = window.location.search;
      var urlParams = new URLSearchParams(queryString);
      var id = urlParams.get('event')

      new Vue({
        el: "#detail-event",
        data: {
          loading: true,
          detail: {},
          list_companies: [],
          company_opened: '',
          company_job: ''
        },
        methods: {
          getDetailEvent() {
            if (id) {
              axios.get(`${url_airtable}/Events?filterByFormula=AND(FIND("Published",{Status}),FIND("${escape(id)}",{Name of the Event}))&view=Grid%20view`, {
                headers: {
                  Authorization: `Bearer ${api_key}`
                }
              }).then(res => {
                if (res.status && res.data.records) {
                  if (res.data.records.length) {
                    this.loading = false
                    this.detail = res.data.records[0]
                  } else {
                    this.loading = false
                  }
                } else {
                  this.loading = false
                }
              }).catch(err => {
                this.loading = false
                console.log(err);
              })
            } else {
              window.location.href = '/indonesia/UAT'
            }
          },
          convertEventName(name) {
            var result = name
  
            if (name.length > 15) {
              result = name.substr(0, 15) + '...';
            }
  
            return result
          },
          convertTime (time) {
            time = time.toString ().match (/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/) || [time];
  
            if (time.length > 1) {
              time = time.slice (1);
              time[5] = +time[0] < 12 ? 'AM' : 'PM';
              time[0] = +time[0] % 12 || 12;
            }
            return time.join ('');
          },
          getDateEvent(date) {
            date = new Date(date)
            
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            var the_day = days[date.getDay()]
            var the_date = date.getDate()
            var the_month = monthNames[date.getMonth()]
            var the_year = date.getFullYear()
  
            return the_day + ', ' + the_date + ' ' + the_month + ' ' + the_year
          },
          getTimeEvent(date) {
            date = new Date(date)
  
            var hour = date.getHours().toString().length == 1 ? '0' + date.getHours() : date.getHours()
            var minute = date.getMinutes().toString().length == 1 ? '0' + date.getMinutes() : date.getMinutes()
            var time = hour + ':' + minute
  
            return this.convertTime(time)
          },
          getCompanies() {
            if (id) {
              axios.get(`${url_airtable}/Employers?maxRecords=6&filterByFormula=AND(FIND("Published",{Status}),FIND("${escape(id)}",{eventID}))&view=Grid%20view`, {
                headers: {
                  Authorization: `Bearer ${api_key}`
                }
              }).then(res => {
                if (res.status && res.data.records.length) {
                  this.list_companies = res.data.records
                  this.company_opened = res.data.records[0].fields['Your Company Name']
                }
              }).catch(err => {
                console.log(err);
              })
            } else {
              window.location.href = '/indonesia/UAT'
            }
          },
          openJob(title) {
            if (!this.company_job) {
              this.company_job = title
            } else {
              this.company_job = ''
            }
          },
          openCompany(name) {
            this.company_opened = name
          }
        },
        mounted() {
          this.getDetailEvent()
          this.getCompanies()
        },
      });
    </script>
  </body>
</html>
